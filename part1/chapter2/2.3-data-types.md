# 2.3 数据类型:文本、数字、列表

## 医学类比:不同类型的病历信息

在病历中,你需要记录不同类型的信息:

| 信息类型 | 医学示例 | 编程数据类型 |
|---------|---------|------------|
| 文字描述 | 姓名、诊断、主诉 | 字符串(String) |
| 数值 | 年龄、体温、血压 | 数字(Number) |
| 是/否判断 | 是否过敏、是否吸烟 | 布尔值(Boolean) |
| 列表 | 既往病史、用药列表 | 列表(List) |
| 结构化信息 | 完整病历记录 | 字典(Dictionary) |

**不同类型的数据,处理方式不同** - 就像你不能把体温写成"很高",也不能把姓名写成数字。

## 1. 字符串(String):文本数据

### 定义
用引号括起来的文本,可以是单引号或双引号

### 医学场景示例

```python
# 患者基本信息
patient_name = "张三"
diagnosis = "2型糖尿病"
chief_complaint = "口渴多饮1月"

# 单引号和双引号都可以
hospital_name = '北京协和医院'
doctor_name = "李医生"
```

### 字符串操作

#### 1) 拼接:组合文本

```python
first_name = "张"
last_name = "三"
full_name = first_name + last_name
print(full_name)  # 输出: 张三

# 生成病历号
year = "2025"
dept_code = "001"
serial = "0123"
medical_id = "MED-" + year + "-" + dept_code + "-" + serial
print(medical_id)  # 输出: MED-2025-001-0123
```

#### 2) 格式化:嵌入变量

```python
patient_name = "王五"
age = 45
diagnosis = "高血压"

# 方法1: f-string(推荐)
report = f"患者{patient_name},年龄{age}岁,诊断:{diagnosis}"
print(report)
# 输出: 患者王五,年龄45岁,诊断:高血压

# 方法2: format()
report2 = "患者{},年龄{}岁,诊断:{}".format(patient_name, age, diagnosis)

# 方法3: %格式化(老式)
report3 = "患者%s,年龄%d岁,诊断:%s" % (patient_name, age, diagnosis)
```

#### 3) 常用字符串方法

```python
diagnosis = "Type 2 Diabetes Mellitus"

# 转大写
print(diagnosis.upper())  # TYPE 2 DIABETES MELLITUS

# 转小写
print(diagnosis.lower())  # type 2 diabetes mellitus

# 替换
new_diagnosis = diagnosis.replace("Type 2", "2型")
print(new_diagnosis)  # 2型 Diabetes Mellitus

# 分割
parts = diagnosis.split(" ")
print(parts)  # ['Type', '2', 'Diabetes', 'Mellitus']

# 去除空格
text = "  高血压  "
print(text.strip())  # 高血压

# 长度
print(len(diagnosis))  # 25
```

### 实战:生成诊断报告

```python
patient_name = "李四"
age = 52
gender = "男"
bp_systolic = 145
bp_diastolic = 92
diagnosis = "原发性高血压2级"

report = f"""
{'='*50}
诊断报告
{'='*50}
姓名: {patient_name}
性别: {gender}
年龄: {age}岁
血压: {bp_systolic}/{bp_diastolic} mmHg
诊断: {diagnosis}
{'='*50}
"""

print(report)
```

输出:
```
==================================================
诊断报告
==================================================
姓名: 李四
性别: 男
年龄: 52岁
血压: 145/92 mmHg
诊断: 原发性高血压2级
==================================================
```

## 2. 数字(Number):数值数据

### 两种主要类型

```python
# 整数(int)
age = 45
heart_rate = 72
patient_count = 100

# 浮点数(float)
temperature = 37.2
blood_glucose = 6.5
bmi = 23.8
```

### 数学运算

```python
# 基本运算
weight = 70  # kg
height = 1.75  # m

# 加减乘除
total_weight = weight + 5  # 75
weight_loss = weight - 3  # 67
double_dose = 10 * 2  # 20
half_dose = 10 / 2  # 5.0

# 幂运算
bmi = weight / (height ** 2)  # 22.86
print(f"BMI: {bmi:.2f}")  # 保留2位小数

# 整除和取余
tablets_needed = 100  # 片
tablets_per_box = 12  # 片/盒

boxes = tablets_needed // tablets_per_box  # 8盒(整除)
remaining = tablets_needed % tablets_per_box  # 4片(余数)
print(f"需要{boxes}盒零{remaining}片")
```

### 数值函数

```python
import math

# 四舍五入
glucose = 6.789
print(round(glucose, 1))  # 6.8
print(round(glucose, 2))  # 6.79

# 绝对值
diff = -2.5
print(abs(diff))  # 2.5

# 最大/最小值
temperatures = [36.5, 37.8, 38.2, 37.1]
print(max(temperatures))  # 38.2
print(min(temperatures))  # 36.5

# 平方根
area = 25
side_length = math.sqrt(area)
print(side_length)  # 5.0
```

### 实战:计算肾小球滤过率(eGFR)

```python
import math

def calculate_egfr(creatinine, age, gender, is_black=False):
    """
    使用CKD-EPI公式计算eGFR

    参数:
    creatinine: 血肌酐(μmol/L)
    age: 年龄(岁)
    gender: 性别("男"或"女")
    is_black: 是否为黑人
    """
    # 转换为mg/dL
    scr = creatinine / 88.4

    # 根据性别设置参数
    if gender == "女":
        kappa = 0.7
        alpha = -0.329
        gender_factor = 1.018
    else:
        kappa = 0.9
        alpha = -0.411
        gender_factor = 1.0

    # 计算eGFR
    egfr = 141 * min(scr/kappa, 1)**alpha * max(scr/kappa, 1)**(-1.209)
    egfr = egfr * (0.993**age) * gender_factor

    if is_black:
        egfr = egfr * 1.159

    return round(egfr, 1)

# 使用
patient_egfr = calculate_egfr(creatinine=88, age=45, gender="男")
print(f"eGFR: {patient_egfr} mL/min/1.73m²")
```

## 3. 布尔值(Boolean):是/否判断

### 定义
只有两个值:`True`(真)或`False`(假)

### 医学场景

```python
# 患者情况
has_diabetes = True
has_hypertension = True
is_pregnant = False
is_allergic_to_penicillin = True

# 检查结果
is_positive = True  # 阳性
is_abnormal = False  # 正常

# 用于条件判断
if has_diabetes:
    print("需要监测血糖")

if not is_pregnant:
    print("可以做X光检查")
```

### 比较运算产生布尔值

```python
temperature = 38.5
blood_glucose = 7.2
age = 65

# 比较运算符
is_fever = temperature > 37.3  # True
is_normal_glucose = blood_glucose < 6.1  # False
is_elderly = age >= 60  # True
is_child = age < 18  # False

# 逻辑运算
has_metabolic_syndrome = (blood_glucose > 6.1) and (bp_systolic > 130)
needs_attention = is_fever or is_abnormal

print(f"发热: {is_fever}")  # 发热: True
print(f"老年患者: {is_elderly}")  # 老年患者: True
```

## 4. 列表(List):多个值的集合

### 定义
用方括号`[]`包裹,逗号分隔的多个值

### 医学场景:患者列表

```python
# 血糖监测记录(一周)
glucose_levels = [6.2, 5.8, 6.5, 7.1, 6.0, 5.9, 6.3]

# 既往病史
medical_history = ["高血压", "糖尿病", "冠心病"]

# 用药列表
medications = ["阿司匹林", "二甲双胍", "阿托伐他汀"]

# 混合类型(不推荐,但可以)
patient_info = ["张三", 45, True, 172.5]
```

### 访问列表元素

```python
medications = ["阿司匹林", "二甲双胍", "阿托伐他汀", "氯吡格雷"]

# 索引从0开始
first_med = medications[0]  # 阿司匹林
second_med = medications[1]  # 二甲双胍

# 负索引从末尾开始
last_med = medications[-1]  # 氯吡格雷
second_last = medications[-2]  # 阿托伐他汀

print(f"首选药物: {first_med}")
print(f"最后添加: {last_med}")
```

### 列表切片

```python
glucose_levels = [6.2, 5.8, 6.5, 7.1, 6.0, 5.9, 6.3]

# 切片语法: list[start:end]  (不包含end)
first_three = glucose_levels[0:3]  # [6.2, 5.8, 6.5]
last_three = glucose_levels[-3:]  # [6.0, 5.9, 6.3]
middle = glucose_levels[2:5]  # [6.5, 7.1, 6.0]

print(f"前3天血糖: {first_three}")
print(f"后3天血糖: {last_three}")
```

### 列表操作

```python
medications = ["阿司匹林", "二甲双胍"]

# 添加元素
medications.append("阿托伐他汀")  # 末尾添加
print(medications)  # ['阿司匹林', '二甲双胍', '阿托伐他汀']

# 插入元素
medications.insert(1, "氯吡格雷")  # 在索引1处插入
print(medications)  # ['阿司匹林', '氯吡格雷', '二甲双胍', '阿托伐他汀']

# 删除元素
medications.remove("二甲双胍")  # 删除指定元素
print(medications)  # ['阿司匹林', '氯吡格雷', '阿托伐他汀']

last = medications.pop()  # 删除并返回最后一个
print(f"停用: {last}")  # 停用: 阿托伐他汀
print(medications)  # ['阿司匹林', '氯吡格雷']

# 列表长度
count = len(medications)
print(f"当前用药{count}种")  # 当前用药2种

# 检查元素是否存在
if "阿司匹林" in medications:
    print("正在服用抗血小板药物")
```

### 实战:血糖数据分析

```python
# 一周血糖记录
glucose_levels = [6.2, 5.8, 6.5, 7.1, 6.0, 5.9, 6.3]

# 基本统计
average = sum(glucose_levels) / len(glucose_levels)
max_glucose = max(glucose_levels)
min_glucose = min(glucose_levels)

# 计算达标率(< 7.0)
target_count = 0
for glucose in glucose_levels:
    if glucose < 7.0:
        target_count += 1

target_rate = (target_count / len(glucose_levels)) * 100

# 生成报告
print(f"{'='*40}")
print(f"血糖监测周报")
print(f"{'='*40}")
print(f"监测天数: {len(glucose_levels)}天")
print(f"平均血糖: {average:.2f} mmol/L")
print(f"最高血糖: {max_glucose} mmol/L")
print(f"最低血糖: {min_glucose} mmol/L")
print(f"达标率: {target_rate:.1f}%")
print(f"{'='*40}")
```

## 5. 字典(Dictionary):键值对结构

### 定义
用花括号`{}`包裹,存储"键:值"对

### 医学场景:结构化病历

```python
# 单个患者完整信息
patient = {
    "姓名": "张三",
    "年龄": 45,
    "性别": "男",
    "身高": 175,  # cm
    "体重": 70,   # kg
    "诊断": ["高血压", "糖尿病"],
    "过敏史": ["青霉素"],
    "血压": {
        "收缩压": 140,
        "舒张压": 90
    }
}

# 访问数据
print(patient["姓名"])  # 张三
print(patient["年龄"])  # 45
print(patient["血压"]["收缩压"])  # 140

# 修改数据
patient["体重"] = 68  # 体重减轻

# 添加新字段
patient["eGFR"] = 95.2

# 安全访问(避免键不存在错误)
allergy = patient.get("药物过敏", "无")  # 如果键不存在,返回"无"
```

### 实战:患者数据库

```python
# 多个患者
patients = [
    {
        "id": "P001",
        "姓名": "张三",
        "年龄": 45,
        "诊断": "高血压"
    },
    {
        "id": "P002",
        "姓名": "李四",
        "年龄": 52,
        "诊断": "糖尿病"
    },
    {
        "id": "P003",
        "姓名": "王五",
        "年龄": 38,
        "诊断": "高血脂"
    }
]

# 查找特定患者
for patient in patients:
    if patient["id"] == "P002":
        print(f"找到患者: {patient['姓名']}, 诊断: {patient['诊断']}")

# 统计
total_age = sum(p["年龄"] for p in patients)
average_age = total_age / len(patients)
print(f"平均年龄: {average_age:.1f}岁")
```

## 数据类型转换

### 类型转换场景

```python
# 字符串转数字
age_str = "45"
age = int(age_str)  # 转整数
print(age + 5)  # 50

glucose_str = "6.5"
glucose = float(glucose_str)  # 转浮点数
print(glucose + 0.5)  # 7.0

# 数字转字符串
age = 45
age_text = str(age)
report = "患者年龄: " + age_text

# 列表转字符串
medications = ["阿司匹林", "二甲双胍", "阿托伐他汀"]
med_text = ", ".join(medications)
print(f"用药: {med_text}")
# 输出: 用药: 阿司匹林, 二甲双胍, 阿托伐他汀

# 字符串转列表
diagnosis_text = "高血压,糖尿病,高血脂"
diagnosis_list = diagnosis_text.split(",")
print(diagnosis_list)  # ['高血压', '糖尿病', '高血脂']
```

## 检查数据类型

```python
age = 45
name = "张三"
has_diabetes = True
glucose_levels = [6.2, 5.8, 6.5]

print(type(age))  # <class 'int'>
print(type(name))  # <class 'str'>
print(type(has_diabetes))  # <class 'bool'>
print(type(glucose_levels))  # <class 'list'>

# 判断类型
if isinstance(age, int):
    print("age是整数")
```

## 💡 关键要点

### 数据类型选择指南

| 数据特征 | 选择类型 | 示例 |
|---------|---------|------|
| 文本描述 | 字符串(str) | 姓名、诊断 |
| 计数/年龄 | 整数(int) | 45岁、10片 |
| 测量值 | 浮点数(float) | 体温37.2、血糖6.5 |
| 是否判断 | 布尔(bool) | 是否过敏、是否阳性 |
| 多个相同类型 | 列表(list) | 血糖监测记录 |
| 结构化信息 | 字典(dict) | 完整病历 |

### 常见错误

```python
# ❌ 错误:字符串当数字用
age = "45"
next_year = age + 1  # 报错!

# ✅ 正确:先转换类型
age = int("45")
next_year = age + 1  # 46

# ❌ 错误:列表索引越界
meds = ["阿司匹林", "二甲双胍"]
third = meds[2]  # 报错!只有0,1两个索引

# ✅ 正确:检查长度
if len(meds) > 2:
    third = meds[2]
```

## 类比总结

| 医学概念 | 数据类型 | 示例 |
|---------|---------|------|
| 患者姓名 | 字符串 | "张三" |
| 患者年龄 | 整数 | 45 |
| 体温读数 | 浮点数 | 37.2 |
| 是否过敏 | 布尔值 | True |
| 既往病史 | 列表 | ["高血压", "糖尿病"] |
| 完整病历 | 字典 | {姓名, 年龄, 诊断...} |

## 下一步

掌握了数据类型,下一节我们将学习[函数:标准化的诊疗流程](2.4-functions.md),把重复的操作封装成可复用的代码块。

---

## 🔨 动手练习

```python
# 练习1:创建患者信息字典
# 包含:姓名、年龄、性别、诊断、用药列表

# 练习2:计算一周血压的平均值
systolic_readings = [140, 135, 142, 138, 145, 136, 141]
# 计算平均收缩压

# 练习3:检查用药列表
medications = ["阿司匹林", "二甲双胍", "阿托伐他汀"]
# 检查是否包含"阿司匹林"
# 添加"氯吡格雷"
# 输出当前用药数量

# 练习4:格式化诊断报告
patient_name = "李四"
age = 52
diagnosis = "2型糖尿病"
# 用f-string生成一句话报告
```

> 💡 提示:打开Python环境,亲自敲一遍代码,观察输出结果!
