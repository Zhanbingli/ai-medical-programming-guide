# 5.2 VSCode配置指南

## 为什么选择VSCode?

VSCode (Visual Studio Code) 是目前最受欢迎的代码编辑器,对于医学AI编程来说,它有三大优势:

1. **完美支持AI编程助手** - GitHub Copilot、Cursor等工具的最佳平台
2. **强大而免费** - 微软出品,完全免费,功能媲美专业IDE
3. **海量扩展** - 几乎所有需求都有对应的插件

## 安装VSCode

### Windows/Mac用户

1. 访问官网: https://code.visualstudio.com
2. 点击"Download"按钮(会自动识别系统)
3. 安装:
   - **Windows**: 运行下载的`.exe`文件,一路"下一步"
   - **Mac**: 打开`.dmg`文件,拖动到Applications文件夹

### 安装验证

安装完成后,打开VSCode,你应该看到欢迎界面。

## 核心配置:打造Python开发环境

### 第一步:安装Python扩展

这是**最重要的一步**!

1. 点击左侧边栏的"扩展"图标(四个方块)
2. 搜索"Python"
3. 安装 **Microsoft官方的Python扩展**
   ```
   发布者: Microsoft
   安装量: 80M+ (数字会变化,选安装量最大的)
   ```
4. 等待安装完成(右下角会显示进度)

### 第二步:连接Python解释器

VSCode需要知道使用哪个Python环境:

1. 打开命令面板:
   - **Mac**: `Cmd + Shift + P`
   - **Windows**: `Ctrl + Shift + P`

2. 输入"Python: Select Interpreter"

3. 选择你的Python环境:
   ```
   推荐选择: ~/anaconda3/bin/python (Anaconda的Python)
   版本: Python 3.x.x 64-bit ('base': conda)
   ```

### 第三步:验证配置

创建测试文件验证配置:

1. 创建新文件: `File > New File`
2. 保存为`test.py` (注意扩展名)
3. 输入代码:
   ```python
   import sys
   print(f"Python版本: {sys.version}")
   print("配置成功!")
   ```
4. 运行代码:
   - 点击右上角的"▶️"按钮
   - 或按 `Ctrl + F5` (Windows) / `Cmd + F5` (Mac)

5. 底部终端应显示:
   ```
   Python版本: 3.x.x ...
   配置成功!
   ```

## 医学编程必备扩展

### 1. Jupyter (官方)

**用途**: 在VSCode中直接使用Jupyter Notebook

**安装**:
```
搜索: Jupyter
发布者: Microsoft
```

**使用**:
- 创建 `.ipynb` 文件即可开始使用
- 获得Jupyter的交互体验 + VSCode的强大功能

### 2. Python Indent

**用途**: 自动处理Python缩进(Python对缩进极其敏感)

**安装**:
```
搜索: Python Indent
发布者: Kevin Rose
```

**效果**: 按回车后自动对齐到正确的缩进位置

### 3. autoDocstring

**用途**: 自动生成函数注释

**安装**:
```
搜索: autoDocstring
发布者: Nils Werner
```

**使用示例**:
```python
def calculate_bmi(weight, height):
    """[光标放这里,输入三个引号后按Tab,自动生成下面的内容]

    Args:
        weight (float): 体重(kg)
        height (float): 身高(m)

    Returns:
        float: BMI值
    """
    return weight / (height ** 2)
```

### 4. Path Intellisense

**用途**: 文件路径自动补全

**安装**:
```
搜索: Path Intellisense
发布者: Christian Kohler
```

**效果**: 输入文件路径时自动提示,避免拼写错误
```python
df = pd.read_csv('data/patient_')  # 会自动提示可用文件
```

### 5. Better Comments

**用途**: 让注释更清晰,用颜色区分不同类型的注释

**安装**:
```
搜索: Better Comments
发布者: Aaron Bond
```

**使用**:
```python
# ! 重要警告: 该函数会修改原始数据!
# ? 疑问: 是否需要处理缺失值?
# TODO: 添加异常值检测
# * 关键步骤: 数据标准化
```

### 6. GitLens (可选,学完第5.7节再装)

**用途**: 增强Git功能,查看代码历史

**安装**:
```
搜索: GitLens
发布者: GitKraken
```

## 推荐设置配置

打开设置: `File > Preferences > Settings` (Mac: `Code > Preferences > Settings`)

或使用快捷键:
- **Mac**: `Cmd + ,`
- **Windows**: `Ctrl + ,`

### 核心设置

在搜索框中输入设置名称,然后修改:

#### 1. 自动保存
```
搜索: Auto Save
设置为: afterDelay
```
**好处**: 写代码时自动保存,不会丢失工作

#### 2. 字体大小(根据个人视力调整)
```
搜索: Font Size
推荐: 14-16
```

#### 3. 显示空白字符(帮助发现缩进问题)
```
搜索: Render Whitespace
设置为: boundary (或 all)
```

#### 4. Python自动格式化
```
搜索: Python > Formatting: Provider
设置为: black (需要先安装: pip install black)
```

#### 5. 保存时自动格式化
```
搜索: Format On Save
勾选: ✅
```

### JSON配置文件(高级用户)

如果你习惯直接编辑配置文件:

1. 打开命令面板 (`Cmd/Ctrl + Shift + P`)
2. 输入"Preferences: Open Settings (JSON)"
3. 添加以下配置:

```json
{
    "editor.fontSize": 14,
    "editor.formatOnSave": true,
    "editor.renderWhitespace": "boundary",
    "files.autoSave": "afterDelay",
    "python.languageServer": "Pylance",
    "jupyter.askForKernelRestart": false,
    "[python]": {
        "editor.defaultFormatter": "ms-python.black-formatter",
        "editor.formatOnSave": true,
        "editor.codeActionsOnSave": {
            "source.organizeImports": true
        }
    }
}
```

## 快捷键速查

### 必须掌握的快捷键

| 功能 | Mac | Windows | 说明 |
|------|-----|---------|------|
| **命令面板** | `Cmd+Shift+P` | `Ctrl+Shift+P` | 最强大功能入口 |
| **快速打开文件** | `Cmd+P` | `Ctrl+P` | 快速搜索并打开文件 |
| **运行代码** | `Shift+Enter` | `Shift+Enter` | 运行当前行/选中代码 |
| **注释/取消注释** | `Cmd+/` | `Ctrl+/` | 批量注释代码 |
| **保存** | `Cmd+S` | `Ctrl+S` | 保存当前文件 |
| **查找** | `Cmd+F` | `Ctrl+F` | 文件内搜索 |
| **全局搜索** | `Cmd+Shift+F` | `Ctrl+Shift+F` | 整个项目搜索 |
| **多光标** | `Cmd+D` | `Ctrl+D` | 选中下一个相同词 |

### 实用技巧

**1. 多光标编辑**

场景: 需要同时修改多个变量名
```python
# 将所有 patient_age 改为 age
patient_age = 45
print(patient_age)
if patient_age > 60:
    print(f"患者年龄: {patient_age}")
```

操作:
1. 双击选中 `patient_age`
2. 按 `Cmd+D` (Mac) / `Ctrl+D` (Windows) 多次,选中所有匹配项
3. 直接输入 `age`,所有位置同时修改!

**2. 快速查找文件**

按 `Cmd+P` (Mac) / `Ctrl+P` (Windows),输入文件名的几个字母:
```
输入: pat → 立即找到 patient_data.py
输入: ana → 立即找到 analysis.ipynb
```

**3. 分屏编辑**

拖动文件标签到右侧 → 自动分屏,对照修改代码

## 工作区推荐布局

### 医学数据分析工作区

```
左侧边栏:
- 资源管理器(文件树)
- 搜索
- Git版本控制
- 扩展

主编辑区:
- 左侧: Python脚本(.py)
- 右侧: Jupyter Notebook(.ipynb)

底部面板:
- 终端(运行命令)
- 输出(查看结果)
- 问题(显示错误)
```

### 设置工作区

1. 打开项目文件夹: `File > Open Folder`
2. 选择你的项目目录(如 `~/medical_projects/`)
3. VSCode会记住这个工作区的所有设置

## 常见问题排查

### Q1: 运行代码提示"找不到Python"

**解决**:
1. `Cmd/Ctrl + Shift + P`
2. 输入 "Python: Select Interpreter"
3. 选择Anaconda的Python路径

### Q2: import pandas 提示找不到模块

**原因**: VSCode使用的Python环境中没有安装pandas

**解决**:
```bash
# 在VSCode底部终端运行
pip install pandas numpy matplotlib
```

### Q3: 代码没有语法高亮/自动补全

**检查**:
1. 文件是否保存为 `.py` 扩展名
2. Python扩展是否已安装并启用
3. 右下角是否显示Python版本(如"Python 3.11.5")

### Q4: 终端中文乱码

**解决** (Windows):
1. 打开设置 (`Ctrl + ,`)
2. 搜索 "terminal.integrated.defaultProfile.windows"
3. 设置为 "Command Prompt" 或 "PowerShell"

## 实战练习

### 练习1: 配置并测试环境

1. 安装Python扩展
2. 创建 `test_env.py`:
   ```python
   import pandas as pd
   import numpy as np
   import matplotlib.pyplot as plt

   print("所有库导入成功!")
   print(f"Pandas版本: {pd.__version__}")
   print(f"NumPy版本: {np.__version__}")
   ```
3. 运行并确保无报错

### 练习2: 熟悉快捷键

完成以下操作,不使用鼠标:
1. 打开命令面板,选择Python解释器
2. 创建新文件,保存为 `shortcut_test.py`
3. 写一行注释,使用快捷键切换注释状态
4. 运行代码

### 练习3: 创建工作区

1. 创建文件夹 `~/medical_analysis/`
2. 在VSCode中打开这个文件夹
3. 创建子文件夹: `data/`, `scripts/`, `notebooks/`
4. 在 `scripts/` 中创建 `utils.py`

## 检查清单

- [ ] VSCode安装成功,能正常打开
- [ ] Python扩展已安装
- [ ] 已选择正确的Python解释器(Anaconda)
- [ ] 能成功运行简单的Python脚本
- [ ] 已安装至少3个推荐扩展
- [ ] 已启用自动保存
- [ ] 熟悉至少5个常用快捷键
- [ ] 能创建并管理工作区

## 下一步

- **5.3 Jupyter Notebook实战**: 在VSCode中使用Jupyter
- **第7章**: 安装AI编程助手(Copilot, Cursor)

## 资源链接

- VSCode官方文档: https://code.visualstudio.com/docs
- Python扩展文档: https://code.visualstudio.com/docs/python/python-tutorial
- 快捷键速查表(PDF): `Help > Keyboard Shortcuts Reference`
