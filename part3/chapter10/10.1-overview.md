# 10.1 临床数据处理场景概述

## 医学数据处理的现实挑战

### 真实场景

**张医生的困境**:
```
临床试验数据文件: trial_data.xlsx
- 500位患者
- 50个变量
- 数据质量问题:
  ❌ 年龄栏有"35岁"和"35"两种格式
  ❌ 血压记录有"120/80"和"120  80"
  ❌ 缺失值用"NA"、"N/A"、"无"、空格表示
  ❌ 日期格式混乱:"2024-01-15"和"01/15/2024"

手工清洗 → 3天 😫
Python自动化 → 30分钟 ✅
```

## 本章覆盖的场景

### 场景1: 数据清洗

**输入**: 混乱的Excel数据
```
患者ID  年龄    性别    收缩压    舒张压
001     35岁    男      120/80
002     42      F       140       90
003     NA      女      135/85
```

**输出**: 标准化数据
```
患者ID  年龄(岁)  性别    收缩压(mmHg)  舒张压(mmHg)
001     35       男      120          80
002     42       女      140          90
003     [删除]
```

### 场景2: 数据验证

**检查项目**:
- ✅ 年龄范围合理(18-120岁)
- ✅ 性别只有"男/女"
- ✅ 血压值在正常范围
- ✅ 日期格式统一
- ✅ 必填字段无缺失
- ✅ 重复患者ID检测

### 场景3: 数据分析

**常见分析任务**:
```python
# 描述性统计
df.describe()

# 组间对比
group_A.mean() vs group_B.mean()

# 相关性分析
df.corr()

# 生存分析
kaplan_meier_curve()
```

### 场景4: 数据可视化

```
需求: 制作论文级别的图表
- 患者基线特征表(Table 1)
- 治疗效果柱状图
- 随访期生存曲线
- 不良事件森林图
```

## 为什么需要AI辅助?

### 传统方式 vs AI辅助

| 任务 | 传统方式 | AI辅助 | 效率提升 |
|------|---------|--------|---------|
| 数据清洗脚本 | 写100行代码,2小时 | 描述需求,10分钟 | 12倍 |
| 统计分析 | 查文档,写代码,1小时 | 让AI生成,5分钟 | 12倍 |
| 制作图表 | 调参数,反复尝试,1小时 | AI生成模板,15分钟 | 4倍 |
| 调试错误 | Google搜索,30分钟 | 让AI解释,2分钟 | 15倍 |

### AI的优势

1. **快速生成代码**: 描述需求 → 立即得到代码
2. **减少语法错误**: AI生成的代码通常语法正确
3. **提供最佳实践**: 自动使用标准库和优化方法
4. **解释代码逻辑**: 不懂的地方让AI解释

## 本章学习路径

```
10.1 场景概述 (本节)
  ↓
10.2 数据清洗实战
  ↓
10.3 数据验证与质控
  ↓
10.4 描述性统计分析
  ↓
10.5 组间对比与假设检验
  ↓
10.6 数据可视化
  ↓
10.7 完整案例:临床试验数据分析
```

## 准备工作

### 所需Python库

```bash
pip install pandas numpy scipy matplotlib seaborn openpyxl
```

### 示例数据集

本章使用的示例数据集:
```
trial_data.xlsx - 临床试验数据
- 患者基本信息
- 实验室检查
- 治疗分组
- 随访数据
```

## 实际应用场景

### 场景A: 科研数据分析

```
博士生的日常:
1. 收集500份病历数据
2. Excel录入
3. 统计分析
4. 制作图表
5. 撰写论文

使用AI辅助:
- 数据清洗自动化
- 统计方法AI推荐
- 图表一键生成
- 结果解读辅助
```

### 场景B: 临床审计

```
质控部门的需求:
- 每月分析1000例病历
- 检查治疗规范性
- 生成审计报告

AI辅助实现:
- 自动识别异常数据
- 批量统计分析
- 自动生成报告
```

### 场景C: 医院管理

```
院长的KPI仪表盘:
- 床位周转率
- 患者满意度
- 科室业绩对比
- 费用分析

AI快速实现:
- 数据自动汇总
- 实时图表更新
- 异常预警
```

## 与AI对话的技巧

### Prompt模板

**数据清洗**:
```
我有一个Excel文件,包含临床试验数据:
- 年龄列格式不统一
- 血压是字符串"120/80"
- 有缺失值

请生成Python代码:
1. 统一年龄格式为数字
2. 拆分血压为收缩压和舒张压两列
3. 删除缺失值超过50%的行
```

**统计分析**:
```
我需要对比A药和B药的疗效:
- 主要指标: 收缩压下降值
- 分组: treatment_group列
- 样本量: 各50人

请生成代码:
1. 描述性统计(均值、标准差)
2. t检验
3. 柱状图对比
```

## 学习目标

完成本章后,你将能够:

✅ 自动清洗和标准化临床数据
✅ 进行基础统计分析(描述性、t检验、卡方检验)
✅ 制作论文级别的图表
✅ 生成临床研究报告
✅ 使用AI快速解决数据问题

## 医学与编程的类比

| 医学概念 | 编程概念 | 说明 |
|---------|---------|------|
| 病史采集 | 数据收集 | 获取原始信息 |
| 体格检查 | 数据验证 | 检查数据质量 |
| 诊断 | 数据分析 | 发现规律和异常 |
| 治疗方案 | 数据处理 | 清洗和转换 |
| 病历记录 | 数据存储 | 规范化保存 |
| 会诊 | AI辅助 | 专家意见 |

## 下一步

[10.2 数据清洗实战](10.2-data-cleaning.md) - 让AI帮你清洗混乱数据
