# 13.4 论文级图表制作

## 期刊要求

### Nature系列期刊要求

```
✅ 分辨率: 300-600 DPI
✅ 格式: TIFF, EPS, PDF
✅ 单栏宽: 89 mm (3.5英寸)
✅ 双栏宽: 183 mm (7.2英寸)
✅ 字体: 5-7 pt (最终大小)
✅ 线宽: 0.25-1 pt
✅ RGB颜色空间
```

## 论文级设置模板

```python
import matplotlib.pyplot as plt
import matplotlib as mpl

# 全局设置
plt.rcParams.update({
    # 图片
    'figure.dpi': 300,
    'figure.figsize': (7, 5),  # 单位:英寸

    # 字体
    'font.size': 12,
    'font.family': 'Arial',
    'axes.labelsize': 14,
    'axes.titlesize': 16,
    'xtick.labelsize': 12,
    'ytick.labelsize': 12,
    'legend.fontsize': 12,

    # 线条
    'axes.linewidth': 1.5,
    'lines.linewidth': 2,
    'xtick.major.width': 1.5,
    'ytick.major.width': 1.5,

    # 其他
    'axes.spines.top': False,
    'axes.spines.right': False,
    'savefig.dpi': 300,
    'savefig.bbox': 'tight',
    'savefig.format': 'png'
})
```

## 完整示例:论文Figure 1

```python
def create_figure1():
    """
    Figure 1: 两组疗效对比
    (A) 柱状图
    (B) 箱线图
    """

    fig, axes = plt.subplots(1, 2, figsize=(7.2, 3.5))

    # (A) 柱状图
    groups = ['A药\n(n=50)', 'B药\n(n=50)']
    means = [15.2, 10.8]
    sems = [0.5, 0.45]

    ax = axes[0]
    bars = ax.bar(groups, means, yerr=sems, capsize=5,
                  color=['#3498db', '#e74c3c'],
                  edgecolor='black', linewidth=1.5)

    # 标注P值
    ax.plot([0, 1], [17, 17], 'k-', linewidth=1.5)
    ax.text(0.5, 17.5, '***\nP<0.001', ha='center', fontsize=12)

    ax.set_ylabel('血压下降值 (mmHg)', fontweight='bold')
    ax.set_ylim(0, 20)
    ax.set_title('(A)', loc='left', fontweight='bold', fontsize=14)

    # (B) 箱线图
    import seaborn as sns
    import pandas as pd

    df = pd.DataFrame({
        '分组': ['A药']*50 + ['B药']*50,
        '血压': np.random.normal(15.2, 3.5, 50).tolist() +
                np.random.normal(10.8, 3.2, 50).tolist()
    })

    ax = axes[1]
    sns.boxplot(data=df, x='分组', y='血压', ax=ax,
                palette=['#3498db', '#e74c3c'])

    ax.set_xlabel('')
    ax.set_ylabel('血压下降值 (mmHg)', fontweight='bold')
    ax.set_title('(B)', loc='left', fontweight='bold', fontsize=14)

    plt.tight_layout()
    plt.savefig('Figure1.png', dpi=600, bbox_inches='tight')
    plt.savefig('Figure1.pdf', format='pdf', bbox_inches='tight')

    print("✓ Figure 1 已生成")

create_figure1()
```

## 黑白打印友好

```python
# 使用不同图案而非颜色
patterns = ['/', '\\', '|', '-', '+', 'x', 'o', 'O', '.', '*']

bars = ax.bar(x, values, color='white', edgecolor='black', linewidth=1.5)

for bar, pattern in zip(bars, patterns):
    bar.set_hatch(pattern)
```

## 检查清单

- [ ] 分辨率≥300 DPI
- [ ] 字体大小合适(≥12pt)
- [ ] 线条清晰(≥1.5pt)
- [ ] 标签完整(含单位)
- [ ] 图例清晰
- [ ] 配色合理
- [ ] 黑白打印可读
- [ ] 文件格式符合要求

## 下一步

[13.5 交互式可视化](13.5-interactive.md)
[13.6 完整案例](13.6-complete-case.md)
