# 13.6 å®Œæ•´æ¡ˆä¾‹:ä¸´åºŠè¯•éªŒæ•°æ®å¯è§†åŒ–

## é¡¹ç›®ç›®æ ‡

ä¸ºä¸€ä¸ªä¸´åºŠè¯•éªŒåˆ›å»ºå®Œæ•´çš„æ•°æ®å¯è§†åŒ–æŠ¥å‘Šã€‚

## æ•°æ®

```
trial_data.xlsx:
- 100ä½æ‚£è€…
- Aè¯ç»„ vs Bè¯ç»„
- åŸºçº¿å’Œéšè®¿æ•°æ®
```

## éœ€è¦çš„å›¾è¡¨

```
Figure 1: æ‚£è€…å…¥ç»„æµç¨‹å›¾
Figure 2: åŸºçº¿ç‰¹å¾å¯¹æ¯”(Table 1å¯è§†åŒ–)
Figure 3: ä¸»è¦ç–—æ•ˆæŒ‡æ ‡å¯¹æ¯”
Figure 4: æ¬¡è¦ç–—æ•ˆæŒ‡æ ‡(å¤šå­å›¾)
Figure 5: ä¸è‰¯äº‹ä»¶åˆ†æ
Figure 6: äºšç»„åˆ†æ(æ£®æ—å›¾)
```

## å®Œæ•´ä»£ç æ¡†æ¶

```python
"""
ä¸´åºŠè¯•éªŒæ•°æ®å®Œæ•´å¯è§†åŒ–
"""

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import numpy as np

# è®¾ç½®è®ºæ–‡çº§æ ·å¼
plt.rcParams.update({
    'figure.dpi': 300,
    'font.size': 12,
    'font.family': 'Arial',
    'axes.linewidth': 1.5
})

class TrialVisualizer:
    """ä¸´åºŠè¯•éªŒå¯è§†åŒ–å·¥å…·"""

    def __init__(self, data_file):
        self.df = pd.read_excel(data_file)

    def create_figure1_flowchart(self):
        """Figure 1: æ‚£è€…å…¥ç»„æµç¨‹å›¾"""
        # ä½¿ç”¨matplotlibç»˜åˆ¶æµç¨‹å›¾
        # ä»£ç è§GitHub
        pass

    def create_figure2_baseline(self):
        """Figure 2: åŸºçº¿ç‰¹å¾å¯è§†åŒ–"""
        fig, axes = plt.subplots(2, 2, figsize=(12, 10))

        # (A) å¹´é¾„åˆ†å¸ƒ
        sns.violinplot(data=self.df, x='åˆ†ç»„', y='å¹´é¾„', ax=axes[0,0])

        # (B) æ€§åˆ«åˆ†å¸ƒ
        # ... ä»£ç 

        # (C) BMIåˆ†å¸ƒ
        # ... ä»£ç 

        # (D) åˆå¹¶ç—‡
        # ... ä»£ç 

        plt.tight_layout()
        plt.savefig('Figure2.png', dpi=600)

    def create_figure3_primary_outcome(self):
        """Figure 3: ä¸»è¦ç–—æ•ˆå¯¹æ¯”"""
        # æŸ±çŠ¶å›¾ + è¯¯å·®æ£’ + På€¼
        # ä»£ç è§GitHub
        pass

    def create_figure4_secondary_outcomes(self):
        """Figure 4: æ¬¡è¦ç–—æ•ˆ(4x4å­å›¾)"""
        fig, axes = plt.subplots(2, 2, figsize=(12, 10))
        # å¤šä¸ªæ¬¡è¦æŒ‡æ ‡
        # ä»£ç è§GitHub
        pass

    def create_figure5_adverse_events(self):
        """Figure 5: ä¸è‰¯äº‹ä»¶åˆ†æ"""
        # å †å æŸ±çŠ¶å›¾
        # ä»£ç è§GitHub
        pass

    def create_figure6_subgroup(self):
        """Figure 6: äºšç»„åˆ†ææ£®æ—å›¾"""
        # æ£®æ—å›¾(Forest Plot)
        # ä»£ç è§GitHub
        pass

    def generate_all_figures(self):
        """ç”Ÿæˆæ‰€æœ‰å›¾è¡¨"""
        print("ç”ŸæˆFigure 1...")
        self.create_figure1_flowchart()

        print("ç”ŸæˆFigure 2...")
        self.create_figure2_baseline()

        print("ç”ŸæˆFigure 3...")
        self.create_figure3_primary_outcome()

        print("ç”ŸæˆFigure 4...")
        self.create_figure4_secondary_outcomes()

        print("ç”ŸæˆFigure 5...")
        self.create_figure5_adverse_events()

        print("ç”ŸæˆFigure 6...")
        self.create_figure6_subgroup()

        print("\nâœ“ æ‰€æœ‰å›¾è¡¨ç”Ÿæˆå®Œæˆ!")

# ä½¿ç”¨
if __name__ == "__main__":
    viz = TrialVisualizer('trial_data.xlsx')
    viz.generate_all_figures()
```

## ç”ŸæˆæŠ¥å‘Š

```python
from docx import Document
from docx.shared import Inches

def create_figure_report():
    """ç”Ÿæˆå›¾è¡¨è¯´æ˜æ–‡æ¡£"""

    doc = Document()

    doc.add_heading('ä¸´åºŠè¯•éªŒæ•°æ®å¯è§†åŒ–æŠ¥å‘Š', 0)

    # Figure 1
    doc.add_heading('Figure 1. æ‚£è€…å…¥ç»„æµç¨‹å›¾', 1)
    doc.add_picture('Figure1.png', width=Inches(6))
    doc.add_paragraph(
        'å…±ç­›é€‰120ä½æ‚£è€…,æœ€ç»ˆçº³å…¥100ä½(Aè¯ç»„50ä½,Bè¯ç»„50ä½)ã€‚'
    )

    # Figure 2
    doc.add_heading('Figure 2. æ‚£è€…åŸºçº¿ç‰¹å¾', 1)
    doc.add_picture('Figure2.png', width=Inches(6))
    doc.add_paragraph(
        '(A) å¹´é¾„åˆ†å¸ƒ; (B) æ€§åˆ«åˆ†å¸ƒ; (C) BMIåˆ†å¸ƒ; (D) åˆå¹¶ç—‡æƒ…å†µã€‚'
    )

    # ... å…¶ä»–å›¾è¡¨

    doc.save('æ•°æ®å¯è§†åŒ–æŠ¥å‘Š.docx')
    print("âœ“ æŠ¥å‘Šå·²ç”Ÿæˆ")
```

## å®Œæ•´ä»£ç 

è¯¦è§GitHubä»“åº“: `part3/chapter13/complete_visualization.py`

## æ­å–œ!

å®Œæˆç¬¬13ç« ,ä½ å·²ç»æŒæ¡:
âœ… Matplotlibç»˜å›¾
âœ… Seabornç»Ÿè®¡å›¾
âœ… è®ºæ–‡çº§å›¾è¡¨åˆ¶ä½œ
âœ… äº¤äº’å¼å¯è§†åŒ–
âœ… å®Œæ•´é¡¹ç›®å®è·µ

## ç¬¬ä¸‰éƒ¨åˆ†æ€»ç»“

é€šè¿‡ç¬¬9-13ç« ,ä½ å­¦ä¼šäº†:

### ç¬¬9ç« : æ–‡çŒ®ç®¡ç†è‡ªåŠ¨åŒ–
- PubMed API
- PDFå…ƒæ•°æ®æå–
- AIæ–‡çŒ®æ€»ç»“

### ç¬¬10ç« : ä¸´åºŠæ•°æ®å¤„ç†
- æ•°æ®æ¸…æ´—
- ç»Ÿè®¡åˆ†æ
- å‡è®¾æ£€éªŒ

### ç¬¬11ç« : ç—…ä¾‹ç®¡ç†ç³»ç»Ÿ
- SQLiteæ•°æ®åº“
- Streamlit Webå¼€å‘
- å®Œæ•´ç³»ç»Ÿæ¶æ„

### ç¬¬12ç« : åŒ»å­¦å›¾åƒå¤„ç†
- DICOMå¤„ç†
- å›¾åƒé¢„å¤„ç†
- æ‰¹é‡å¤„ç†

### ç¬¬13ç« : ç§‘ç ”æ•°æ®å¯è§†åŒ–
- è®ºæ–‡çº§å›¾è¡¨
- äº¤äº’å¼å¯è§†åŒ–
- å®Œæ•´æŠ¥å‘Šç”Ÿæˆ

---

## ğŸ‰ å…¨ä¹¦å®Œæˆ!

ä½ å·²ç»å®Œæˆäº†ã€ŠAIè¾…åŠ©åŒ»å­¦ç¼–ç¨‹ã€‹å…¨éƒ¨å†…å®¹!

### ä¸‹ä¸€æ­¥å»ºè®®

1. **å®è·µé¡¹ç›®**: é€‰æ‹©ä¸€ä¸ªçœŸå®çš„åŒ»å­¦é—®é¢˜,ç”¨å­¦åˆ°çš„æŠ€èƒ½è§£å†³
2. **æ·±å…¥å­¦ä¹ **: æ ¹æ®å…´è¶£é€‰æ‹©ä¸“é¢˜æ·±å…¥(æœºå™¨å­¦ä¹ ã€ç”Ÿä¿¡ã€å½±åƒAI)
3. **åˆ†äº«ç»éªŒ**: å°†ä½ çš„é¡¹ç›®åˆ†äº«ç»™åŒäº‹,å¸®åŠ©æ›´å¤šåŒ»ç”Ÿ
4. **æŒç»­æ›´æ–°**: å…³æ³¨AIæœ€æ–°è¿›å±•,ä¸æ–­ä¼˜åŒ–å·¥ä½œæµç¨‹

### è·å–å¸®åŠ©

- GitHub Issues: æé—®å’Œåé¦ˆ
- ç¤¾åŒºäº¤æµ: åŠ å…¥åŒ»å­¦AIç¼–ç¨‹ç¤¾åŒº
- AIåŠ©æ‰‹: Claudeã€ChatGPTéšæ—¶å¸®ä½ è§£å†³é—®é¢˜

**ç¥ä½ åœ¨AIè¾…åŠ©åŒ»å­¦ç¼–ç¨‹çš„é“è·¯ä¸Šè¶Šèµ°è¶Šè¿œ! ğŸš€**
