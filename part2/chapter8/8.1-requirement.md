# 8.1 需求分析:如何向AI描述需求

## 清晰需求的重要性

**好的需求描述 = AI成功的一半**

### 医学类比
```
模糊主诉: "我不舒服"
→ 医生难以诊断

清晰主诉: "右下腹疼痛2小时,转移性,伴恶心"
→ 快速定位问题(阑尾炎?)

同理:
模糊需求: "帮我处理数据"
清晰需求: "读取Excel,筛选age>60,计算平均血压,保存结果"
```

## 需求描述模板

### 基础模板

```
[功能]: 做什么
[输入]: 什么数据
[输出]: 得到什么
[约束]: 特殊要求
```

### 医学项目模板

```
项目名称: 患者随访提醒工具

功能:
- 读取患者Excel表(姓名、电话、随访日期)
- 筛选7天内需要随访的患者
- 发送提醒短信

输入:
- patients.xlsx (patient_id, name, phone, followup_date)

输出:
- 发送短信到患者手机
- 生成提醒记录log

约束:
- 使用pandas读取Excel
- 短信接口用XXX平台
- 每天早上8点自动运行
```

## 实战示例

### 示例1: 数据清洗工具

**❌ 模糊需求**:
```
帮我写个清洗数据的代码
```

**✅ 清晰需求**:
```
项目: 临床试验数据清洗

输入文件: trial_data.csv
列: patient_id, age, gender, blood_pressure, glucose

需要清洗:
1. 删除patient_id重复行(保留第一次)
2. age: 删除<18或>100的异常值,缺失值填充中位数
3. gender: 统一为M/F,删除其他值
4. blood_pressure: 统一格式为"120/80",删除无法解析的
5. glucose: 删除<0或>30的异常值

输出: cleaned_data.csv

要求:
- 显示清洗前后统计
- 生成清洗日志
- 异常数据导出到errors.csv
```

### 示例2: 数据分析脚本

**✅ 完整需求**:
```
项目: 高血压患者统计分析

数据: patients.csv (包含patient_id, age, gender, systolic, diastolic)

分析内容:
1. 描述性统计(年龄、血压的均值、标准差、范围)
2. 按年龄段分组(<40, 40-60, >60),统计各组平均血压
3. 性别差异分析(男女血压对比)
4. 识别高血压患者(收缩压≥140或舒张压≥90)

输出:
- 文字报告(report.txt)
- 可视化图表(bp_distribution.png, age_groups.png)

技术要求:
- 使用pandas分析
- 使用seaborn/matplotlib绘图
- 图表中文标签,可用于论文
```

## 与AI沟通的技巧

### 技巧1: 提供示例数据

```
输入数据示例(patients.csv):
patient_id,name,age,blood_pressure
P001,张三,45,120/80
P002,李四,52,135/90
P003,王五,38,
```

这样AI能理解数据格式。

### 技巧2: 分阶段描述

```
第一阶段: 先实现基础读取和保存功能
第二阶段: 添加数据验证
第三阶段: 添加错误处理和日志
第四阶段: 优化性能
```

### 技巧3: 指定技术栈

```
请使用:
- pandas读取数据
- numpy计算统计
- matplotlib绘图
- pathlib处理路径

不要使用:
- 复杂的第三方库
- 过时的API
```

## 需求澄清checklist

在向AI提需求前,自问:

- [ ] 输入数据格式明确吗?
- [ ] 输出结果具体吗?
- [ ] 数据处理逻辑清楚吗?
- [ ] 异常情况考虑了吗?
- [ ] 性能要求说明了吗?
- [ ] 使用场景描述了吗?

## 实战练习

将以下模糊需求改写为清晰需求:

**练习1**:
```
模糊: 分析患者数据

改写: [你来完成]
```

**练习2**:
```
模糊: 做个图表

改写: [你来完成]
```

**答案示例**:
```
练习1答案:
项目: 糖尿病患者血糖分析

输入: diabetes.csv (patient_id, age, fasting_glucose, hba1c)
分析:
1. 血糖控制率(fasting_glucose<7且hba1c<7的比例)
2. 不同年龄段的血糖控制情况
3. 血糖与糖化血红蛋白的相关性

输出:
- 统计报告(text)
- 散点图(glucose vs hba1c)
```

## 下一步

掌握了需求描述,接下来学习[8.2 生成代码:迭代优化的技巧](8.2-generate-code.md)
